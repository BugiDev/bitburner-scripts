import {CONFIG} from "/scripts/config";
import {log} from "/scripts/util";

export async function main(ns) {
    const serverName = ns.args[0];
    const debug = ns.args[1] || false;
    await installMalware(ns, serverName, debug);
}

export async function installMalware(ns, serverName, debug = false) {
    if (
        ns.hasRootAccess(serverName) &&
        !ns.fileExists(CONFIG.malwareFile, serverName) &&
        !ns.fileExists(CONFIG.loopMalwareWeaken, serverName) &&
        !ns.fileExists(CONFIG.loopMalwareGrow, serverName) &&
        !ns.fileExists(CONFIG.loopMalwareHack, serverName)
    ) {
        await ns.scp(CONFIG.malwareFile, serverName);
        await ns.scp(CONFIG.loopMalwareWeaken, serverName);
        await ns.scp(CONFIG.loopMalwareGrow, serverName);
        await ns.scp(CONFIG.loopMalwareHack, serverName);
        log(ns, `Installed malware on: ${serverName}`, debug);
    }
}